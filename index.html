<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>IPTV Pro - Cargador</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <style>
        body { margin: 0; background: #000; color: white; font-family: sans-serif; display: flex; height: 100vh; }
        .sidebar { width: 300px; background: #111; border-right: 1px solid #333; display: flex; flex-direction: column; }
        .sidebar-header { padding: 15px; border-bottom: 1px solid #333; text-align: center; }
        #channel-list { flex-grow: 1; overflow-y: auto; padding: 10px; }
        .channel-btn { width: 100%; padding: 10px; background: #222; border: none; color: white; text-align: left; margin-bottom: 5px; cursor: pointer; border-radius: 4px; font-size: 13px; }
        .channel-btn:hover { background: #fb542b; }
        .main { flex-grow: 1; display: flex; flex-direction: column; background: #000; }
        .video-js { width: 100% !important; height: 100% !important; }
        .file-input-label { background: #fb542b; padding: 10px; display: block; cursor: pointer; border-radius: 5px; font-weight: bold; font-size: 14px; }
        #file-input { display: none; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <label for="file-input" class="file-input-label">ðŸ“‚ CARGAR ARCHIVO .M3U</label>
            <input type="file" id="file-input" accept=".m3u,.txt">
            <p style="font-size: 10px; color: #888; margin-top: 10px;">Selecciona tu lista IPTV</p>
        </div>
        <div id="channel-list">
            </div>
    </div>

    <div class="main">
        <video id="my-video" class="video-js vjs-big-play-centered" controls preload="auto"></video>
    </div>

    <script>
        var player = videojs('my-video');
        const fileInput = document.getElementById('file-input');
        const channelList = document.getElementById('channel-list');

        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            const reader = new FileReader();
            
            reader.onload = function(event) {
                const content = event.target.result;
                parseM3U(content);
            };
            reader.readAsText(file);
        });

        function parseM3U(content) {
            channelList.innerHTML = ''; // Limpiar lista
            const lines = content.split('\n');
            let currentName = '';

            lines.forEach(line => {
                line = line.trim();
                if (line.startsWith('#EXTINF:')) {
                    // Extraer nombre del canal
                    currentName = line.split(',').pop();
                } else if (line.startsWith('http')) {
                    // Crear botÃ³n para el link
                    const btn = document.createElement('button');
                    btn.className = 'channel-btn';
                    btn.textContent = currentName || 'Canal sin nombre';
                    const url = line;
                    btn.onclick = () => play(url);
                    channelList.appendChild(btn);
                    currentName = ''; // Reset para el prÃ³ximo
                }
            });
        }

        function play(url) {
            player.src({ src: url, type: 'application/x-mpegURL' });
            player.play();
        }
    </script>
</body>
</html>
